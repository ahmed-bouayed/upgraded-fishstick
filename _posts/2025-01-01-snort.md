---
title: title
description: description
published: true
date: 2025-01-01
categories: security
tags: ids ips   
image:
  path: /assets/img/headers/image.webp
  lqip: data:image/webp;base64,
  alt: image
---
1. Update and Upgrade

Update package lists and Upgrade existing packages:

shell

sudo apt update && sudo apt upgrade -y


2. Install Snort

Install Snort:
shell

sudo apt install snort -y

This command will install Snort and its dependencies.
During installation, you might be prompted to select the network interface Snort should listen on. Use the ip a command to determine the appropriate interface.
3. Configure Snort

backup the configuration file:

shell
sudo cp /etc/snort/snort.conf /etc/snort/snort.conf.backup

Edit the configuration file:

sudo nano /etc/snort/snort.conf
Configure Network Variables:

HOME_NET: Define your internal network IP address range.
Example: ipvar HOME_NET 192.168.1.0/24



Test the Configuration:

shell

sudo snort -T -i <interface_name> -c /etc/snort/snort.conf

Start Snort as a service:

Create a systemd service file:

Create a file (e.g., /etc/systemd/system/snort.service) with the following content:
Ini, TOML

[Unit]
Description=Snort Intrusion Detection System
After=network.target

[Service]
Type=oneshot
ExecStart=/usr/sbin/snort -i <interface_name> -c /etc/snort/snort.conf -l /var/log/snort 
ExecStart=/usr/sbin/ip link set dev eth0 promisc on
ExecStart=/usr/sbin/ethtool -K eth0 gro off lro off 
TimeoutStartSec=0 
RemainAfterExit=yes

User=snort 
Group=snort 

[Install]
WantedBy=multi-user.target



Create a user and group for Snort:

shell
sudo adduser --system snort

Enable and start the Snort service:

shell

sudo systemctl daemon-reload
sudo systemctl enable snort.service
sudo systemctl start snort.service

sudo systemctl status snort.service

Important Notes:

Rule Development: Snort's effectiveness heavily relies on the quality of its rule sets. Learn how to write and manage Snort rules.
False Positives/Negatives: Fine-tune your rules and configuration to minimize false positives and negatives.
Performance Monitoring: Monitor Snort's performance and resource usage.
Security Best Practices: Keep Snort and its rule sets updated. Regularly review and adjust your security policies.
This guide provides a basic installation and configuration of Snort. For advanced use cases and in-depth configurations, refer to the official Snort documentation.



1. Download Community Rules

Obtain the latest rules: Download the latest community rules archive from the official Snort website:
shell

wget https://www.snort.org/downloads/community/community-rules.tar.gz
2. Extract Rules

Extract the archive: Extract the downloaded archive to the appropriate Snort rules directory:
shell

sudo tar -xvzf community-rules.tar.gz -C /etc/snort/rules/ 
3. Configure Snort

Edit the Snort configuration file:

shell

sudo nano /etc/snort/snort.conf
Include community rules: Uncomment the line in snort.conf that includes the community rules:

#include $RULE_PATH/community.rules 
(Remove the leading "#" to activate the line)

4. Test Configuration

Validate the configuration:
shell

sudo snort -T -i <interface_name> -c /etc/snort/snort.conf
(Replace <interface_name> with the actual network interface)
5. Restart Snort

Restart the Snort service:
shell

sudo systemctl restart snort.service 
Updating Community Rules

1. Download the Latest Version

Download the new rules archive: Download the latest version of the community rules archive from the Snort website.
2. Replace Existing Rules

Back up the existing rules: (Optional, but recommended)

shell

sudo cp -r /etc/snort/rules/community* /etc/snort/rules/community_backup_$(date +%Y%m%d) 
Extract the new rules:

shell

sudo tar -xvzf community-rules.tar.gz -C /etc/snort/rules/ 
Note: This will overwrite the existing community rules files.

3. Restart Snort

Restart the Snort service:
shell

sudo systemctl restart snort.service



How to Add Custom Rules to Snort
Open the Snort rules file:

shell
Copy
sudo nano /etc/snort/rules/local.rules
Add your custom rules to the file. For example:

plaintext
Copy
alert tcp any any -> any 80 (msg:"Suspicious HTTP Request to /admin"; content:"GET /admin"; nocase; sid:1000101;)
alert icmp any any -> any any (msg:"ICMP Ping Detected"; itype:8; sid:1000102;)
alert tcp any any -> any 21 (msg:"FTP Login Attempt"; content:"USER"; nocase; sid:1000103;)
alert udp any any -> any 53 (msg:"Suspicious DNS Query Length"; dns_query; byte_test:1,>,64,0; sid:1000104;)
alert tcp any any -> any 3389 (msg:"RDP Brute Force Attempt"; threshold: type threshold, track by_src, count 5, seconds 60; sid:1000105;)
Save and exit the file.

Test the configuration to ensure there are no syntax errors:

shell
Copy
sudo snort -T -c /etc/snort/snort.conf
Restart Snort to apply the new rules:

shell
Copy
sudo systemctl restart snort
Testing Custom Rules
Use tools like curl, nmap, or ping to generate traffic that matches your custom rules.

Check Snort logs to verify that the rules are triggering alerts:

shell
Copy
sudo tail -f /var/log/snort/alert
